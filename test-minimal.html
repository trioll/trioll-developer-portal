<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Minimal Test - Trioll</title>
</head>
<body>
    <h1>Minimal Test Page</h1>
    <p>This page has NO AWS SDK or scripts loaded.</p>
    <p>If you still see AWS errors in console, the issue is external (browser extension, service worker, etc).</p>
    
    <button onclick="testUpload()">Test Upload API Directly</button>
    <div id="result"></div>
    
    <script>
    async function testUpload() {
        const resultDiv = document.getElementById('result');
        resultDiv.innerHTML = 'Testing...';
        
        try {
            // Get token from storage
            const token = localStorage.getItem('developerToken') || sessionStorage.getItem('developerToken');
            if (!token) {
                resultDiv.innerHTML = 'No auth token found. Please login first.';
                return;
            }
            
            const testFile = new Blob(['<html><body>Test Game</body></html>'], {type: 'text/html'});
            const gameId = 'test-' + Date.now();
            
            // Call upload API
            const response = await fetch('https://4ib0hvu1xj.execute-api.us-east-1.amazonaws.com/prod/upload/initiate', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${token}`
                },
                body: JSON.stringify({
                    gameId: gameId,
                    files: [{
                        name: 'index.html',
                        size: testFile.size,
                        type: 'text/html'
                    }]
                })
            });
            
            if (response.ok) {
                const data = await response.json();
                resultDiv.innerHTML = '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
            } else {
                resultDiv.innerHTML = 'Error: ' + response.status + ' ' + await response.text();
            }
            
        } catch (error) {
            resultDiv.innerHTML = 'Error: ' + error.message;
        }
    }
    </script>
</body>
</html>