<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Game Upload Fields</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #0f0f0f;
            color: #fff;
        }
        .test-section {
            background: #1a1a1a;
            padding: 20px;
            margin: 20px 0;
            border-radius: 12px;
            border: 1px solid #2a2a2a;
        }
        .field-list {
            background: #0f0f0f;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 14px;
        }
        .field {
            margin: 5px 0;
            padding: 5px 10px;
            border-radius: 4px;
        }
        .field-present {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        .field-missing {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            font-size: 16px;
        }
        button:hover {
            background: #2563eb;
        }
        .result {
            margin-top: 15px;
            padding: 15px;
            background: #0f0f0f;
            border-radius: 8px;
            font-family: monospace;
            white-space: pre-wrap;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <h1>üß™ Test Game Upload Field Storage</h1>
    
    <div class="test-section">
        <h2>Expected Fields for Game Upload</h2>
        <div class="field-list">
            <div class="field">‚úÖ gameId - Unique identifier</div>
            <div class="field">‚úÖ name/title - Game name</div>
            <div class="field">‚úÖ category - Game category</div>
            <div class="field">‚úÖ description - Game description</div>
            <div class="field">‚úÖ developer - Developer name/company</div>
            <div class="field field-present">‚≠ê developerId - Developer unique ID (e.g., dev_freddi)</div>
            <div class="field">‚úÖ deviceOrientation - Portrait/Landscape/Both</div>
            <div class="field">‚úÖ controlStyle - Touch/Button/Both</div>
            <div class="field">‚úÖ gameStage - Beta/Launch/Archive</div>
            <div class="field">‚úÖ deviceCompatibility - Array of supported devices</div>
            <div class="field">‚úÖ buildId - Unique build identifier</div>
            <div class="field">‚úÖ gameUrl - S3 URL for game files</div>
            <div class="field">‚úÖ thumbnailUrl - S3 URL for thumbnail</div>
            <div class="field">‚úÖ s3Folder - S3 folder name</div>
            <div class="field">‚úÖ uploadedFiles - Number of files uploaded</div>
            <div class="field">‚úÖ uploadedAt - Timestamp of upload</div>
            <div class="field">‚úÖ status - active/inactive</div>
            <div class="field">‚úÖ plays - Initial play count (0)</div>
            <div class="field">‚úÖ likes - Initial like count (0)</div>
            <div class="field">‚úÖ rating - Initial rating (0)</div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>Test Game Upload Payload</h2>
        <button onclick="showSamplePayload()">Show Sample Upload Payload</button>
        <div id="payloadResult" class="result"></div>
    </div>
    
    <div class="test-section">
        <h2>Test API Endpoint</h2>
        <button onclick="testGameCreation()">Test Game Creation API</button>
        <div id="apiResult" class="result"></div>
    </div>

    <script>
        function showSamplePayload() {
            const resultDiv = document.getElementById('payloadResult');
            
            const samplePayload = {
                gameId: "game_" + Date.now(),
                name: "Test Game with Developer ID",
                title: "Test Game with Developer ID",
                category: "action",
                description: "Testing if developer ID is stored",
                developer: "FreddieTrioll",
                developerId: "dev_freddi", // This is what we want to ensure is saved
                deviceOrientation: "both",
                controlStyle: "touchscreen",
                gameStage: "beta",
                deviceCompatibility: ["ios", "android", "computer"],
                buildId: "BUILD-123456-TEST",
                gameUrl: "https://trioll-prod-games.s3.amazonaws.com/test-game/index.html",
                thumbnailUrl: "https://trioll-prod-games.s3.amazonaws.com/test-game/thumbnail.png",
                s3Folder: "test-game",
                uploadedFiles: 5,
                uploadedAt: new Date().toISOString(),
                status: "active",
                publishedAt: new Date().toISOString(),
                plays: 0,
                likes: 0,
                rating: 0
            };
            
            resultDiv.textContent = 'Sample payload that should be sent to backend:\n\n';
            resultDiv.textContent += JSON.stringify(samplePayload, null, 2);
            resultDiv.textContent += '\n\n‚≠ê Key field: developerId = "dev_freddi"';
        }
        
        async function testGameCreation() {
            const resultDiv = document.getElementById('apiResult');
            resultDiv.textContent = 'Testing game creation API...\n\n';
            
            const token = localStorage.getItem('developerToken') || sessionStorage.getItem('developerToken');
            
            if (!token) {
                resultDiv.textContent += '‚ùå No authentication token found. Please login to the developer portal first.';
                return;
            }
            
            const testGame = {
                gameId: "test_" + Date.now(),
                name: "Developer ID Test Game",
                title: "Developer ID Test Game",
                category: "test",
                description: "Testing developer ID storage",
                developer: "Test Developer",
                developerId: "dev_freddi",
                deviceOrientation: "both",
                controlStyle: "touchscreen",
                gameStage: "beta",
                deviceCompatibility: ["all"],
                buildId: "TEST-" + Date.now(),
                gameUrl: "https://example.com/test-game",
                thumbnailUrl: "https://example.com/test-thumbnail.png",
                s3Folder: "test-folder",
                uploadedFiles: 1,
                uploadedAt: new Date().toISOString(),
                status: "active",
                publishedAt: new Date().toISOString(),
                plays: 0,
                likes: 0,
                rating: 0
            };
            
            try {
                const response = await fetch('https://4ib0hvu1xj.execute-api.us-east-1.amazonaws.com/prod/games', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify(testGame)
                });
                
                const responseText = await response.text();
                
                resultDiv.textContent += `Response Status: ${response.status}\n`;
                resultDiv.textContent += `Response:\n${responseText}\n\n`;
                
                if (response.ok) {
                    resultDiv.textContent += '‚úÖ Game creation API is working\n';
                    resultDiv.textContent += '‚ö†Ô∏è  Check if developerId was actually saved by querying the game';
                } else {
                    resultDiv.textContent += '‚ùå Game creation failed\n';
                    resultDiv.textContent += 'This might be normal if the Lambda expects actual game files';
                }
            } catch (error) {
                resultDiv.textContent += `‚ùå Error: ${error.message}`;
            }
        }
    </script>
</body>
</html>